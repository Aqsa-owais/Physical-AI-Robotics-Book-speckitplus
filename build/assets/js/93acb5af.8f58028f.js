"use strict";(globalThis.webpackChunkphysical_ai_robotics_book=globalThis.webpackChunkphysical_ai_robotics_book||[]).push([[621],{38:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>m,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"module-1-ros/communication","title":"Communication between AI Logic and Robot Controllers","description":"Introduction","source":"@site/docs/module-1-ros/communication.md","sourceDirName":"module-1-ros","slug":"/module-1-ros/communication","permalink":"/giaic-hackathon-speckit-plus/docs/module-1-ros/communication","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module-1-ros/communication.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Python-based ROS 2 Development using rclpy","permalink":"/giaic-hackathon-speckit-plus/docs/module-1-ros/python-ros"},"next":{"title":"Humanoid Robot Description using URDF","permalink":"/giaic-hackathon-speckit-plus/docs/module-1-ros/urdf"}}');var s=o(4848),i=o(8453);const a={sidebar_position:5},l="Communication between AI Logic and Robot Controllers",r={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Architecture Overview",id:"architecture-overview",level:2},{value:"High-Level vs. Low-Level Components",id:"high-level-vs-low-level-components",level:3},{value:"Communication Patterns",id:"communication-patterns",level:3},{value:"Communication Channels",id:"communication-channels",level:2},{value:"Command Channels",id:"command-channels",level:3},{value:"Joint Commands",id:"joint-commands",level:4},{value:"Velocity Commands",id:"velocity-commands",level:4},{value:"State Feedback Channels",id:"state-feedback-channels",level:3},{value:"Joint State Feedback",id:"joint-state-feedback",level:4},{value:"Robot State Feedback",id:"robot-state-feedback",level:4},{value:"Integration Patterns",id:"integration-patterns",level:2},{value:"Behavior-Based Architecture",id:"behavior-based-architecture",level:3},{value:"Action-Based Integration",id:"action-based-integration",level:3},{value:"Safety Considerations",id:"safety-considerations",level:2},{value:"Emergency Stop Integration",id:"emergency-stop-integration",level:3},{value:"State Validation",id:"state-validation",level:3},{value:"Advanced Integration: AI-Controller Coordination",id:"advanced-integration-ai-controller-coordination",level:2},{value:"Coordination Node",id:"coordination-node",level:3},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Communication Frequency",id:"communication-frequency",level:3},{value:"Quality of Service Settings",id:"quality-of-service-settings",level:3},{value:"Summary",id:"summary",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"communication-between-ai-logic-and-robot-controllers",children:"Communication between AI Logic and Robot Controllers"})}),"\n",(0,s.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsx)(n.p,{children:"One of the core challenges in robotics is enabling effective communication between high-level AI logic and low-level robot controllers. The AI logic makes decisions based on perception, planning, and reasoning, while controllers execute these decisions by commanding actuators and processing sensor feedback. ROS 2 provides the communication infrastructure to bridge these different system components."}),"\n",(0,s.jsx)(n.h2,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,s.jsx)(n.h3,{id:"high-level-vs-low-level-components",children:"High-Level vs. Low-Level Components"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"High-Level AI Components:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Perception systems (object detection, SLAM, etc.)"}),"\n",(0,s.jsx)(n.li,{children:"Planning systems (path planning, task planning)"}),"\n",(0,s.jsx)(n.li,{children:"Reasoning systems (decision making, cognitive architectures)"}),"\n",(0,s.jsx)(n.li,{children:"User interfaces and command systems"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Low-Level Controller Components:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Joint position/velocity/effort controllers"}),"\n",(0,s.jsx)(n.li,{children:"Sensor drivers and processing"}),"\n",(0,s.jsx)(n.li,{children:"Safety and emergency systems"}),"\n",(0,s.jsx)(n.li,{children:"Hardware abstraction layers"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"communication-patterns",children:"Communication Patterns"}),"\n",(0,s.jsx)(n.p,{children:"The communication between AI logic and robot controllers typically follows these patterns:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Commands"}),": AI logic sends commands to controllers"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"State feedback"}),": Controllers report robot state back to AI"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Sensor data"}),": Controllers provide processed sensor data"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Status updates"}),": Controllers report operational status"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"communication-channels",children:"Communication Channels"}),"\n",(0,s.jsx)(n.h3,{id:"command-channels",children:"Command Channels"}),"\n",(0,s.jsx)(n.p,{children:"AI logic sends commands to robot controllers through various message types:"}),"\n",(0,s.jsx)(n.h4,{id:"joint-commands",children:"Joint Commands"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom control_msgs.msg import JointTrajectoryControllerState\nfrom trajectory_msgs.msg import JointTrajectory, JointTrajectoryPoint\n\nclass AICommander(Node):\n\n    def __init__(self):\n        super().__init__('ai_commander')\n        self.joint_pub = self.create_publisher(JointTrajectory, '/joint_trajectory_controller/joint_trajectory', 10)\n\n    def send_joint_command(self, joint_names, positions, velocities=None, accelerations=None):\n        msg = JointTrajectory()\n        msg.joint_names = joint_names\n\n        point = JointTrajectoryPoint()\n        point.positions = positions\n        if velocities:\n            point.velocities = velocities\n        if accelerations:\n            point.accelerations = accelerations\n\n        # Set execution time (1 second from now)\n        point.time_from_start.sec = 1\n        msg.points = [point]\n\n        self.joint_pub.publish(msg)\n"})}),"\n",(0,s.jsx)(n.h4,{id:"velocity-commands",children:"Velocity Commands"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from geometry_msgs.msg import Twist\n\nclass NavigationAI(Node):\n\n    def __init__(self):\n        super().__init__('navigation_ai')\n        self.cmd_vel_pub = self.create_publisher(Twist, '/cmd_vel', 10)\n\n    def send_velocity_command(self, linear_x, angular_z):\n        msg = Twist()\n        msg.linear.x = linear_x\n        msg.angular.z = angular_z\n        self.cmd_vel_pub.publish(msg)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"state-feedback-channels",children:"State Feedback Channels"}),"\n",(0,s.jsx)(n.p,{children:"Controllers report robot state back to AI systems:"}),"\n",(0,s.jsx)(n.h4,{id:"joint-state-feedback",children:"Joint State Feedback"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from sensor_msgs.msg import JointState\n\nclass StateMonitor(Node):\n\n    def __init__(self):\n        super().__init__('state_monitor')\n        self.joint_sub = self.create_subscription(\n            JointState,\n            '/joint_states',\n            self.joint_state_callback,\n            10)\n\n    def joint_state_callback(self, msg):\n        # Process joint positions, velocities, efforts\n        for i, name in enumerate(msg.name):\n            position = msg.position[i] if i < len(msg.position) else 0.0\n            velocity = msg.velocity[i] if i < len(msg.velocity) else 0.0\n            effort = msg.effort[i] if i < len(msg.effort) else 0.0\n\n            # Update AI system with current state\n            self.update_robot_state(name, position, velocity, effort)\n"})}),"\n",(0,s.jsx)(n.h4,{id:"robot-state-feedback",children:"Robot State Feedback"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from nav_msgs.msg import Odometry\n\nclass OdomMonitor(Node):\n\n    def __init__(self):\n        super().__init__('odom_monitor')\n        self.odom_sub = self.create_subscription(\n            Odometry,\n            '/odom',\n            self.odom_callback,\n            10)\n\n    def odom_callback(self, msg):\n        # Extract position and orientation\n        x = msg.pose.pose.position.x\n        y = msg.pose.pose.position.y\n        z = msg.pose.pose.position.z\n\n        # Extract orientation (quaternion)\n        qx = msg.pose.pose.orientation.x\n        qy = msg.pose.pose.orientation.y\n        qz = msg.pose.pose.orientation.z\n        qw = msg.pose.pose.orientation.w\n\n        # Update AI navigation system\n        self.update_navigation_state(x, y, z, qx, qy, qz, qw)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"integration-patterns",children:"Integration Patterns"}),"\n",(0,s.jsx)(n.h3,{id:"behavior-based-architecture",children:"Behavior-Based Architecture"}),"\n",(0,s.jsx)(n.p,{children:"This pattern organizes robot behaviors as separate nodes that communicate through ROS topics:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# Behavior 1: Obstacle Avoidance\nclass ObstacleAvoidance(Node):\n\n    def __init__(self):\n        super().__init__('obstacle_avoidance')\n        self.laser_sub = self.create_subscription(LaserScan, '/scan', self.scan_callback, 10)\n        self.cmd_pub = self.create_publisher(Twist, '/cmd_vel', 10)\n\n    def scan_callback(self, msg):\n        # Process laser scan to detect obstacles\n        min_distance = min(msg.ranges)\n\n        if min_distance < 1.0:  # Too close to obstacle\n            cmd = Twist()\n            cmd.linear.x = 0.0\n            cmd.angular.z = 0.5  # Turn away\n            self.cmd_pub.publish(cmd)\n\n# Behavior 2: Goal Navigation\nclass GoalNavigator(Node):\n\n    def __init__(self):\n        super().__init__('goal_navigator')\n        self.goal_sub = self.create_subscription(Pose, '/goal', self.goal_callback, 10)\n        self.cmd_pub = self.create_publisher(Twist, '/cmd_vel', 10)\n\n    def goal_callback(self, msg):\n        # Navigate to goal\n        cmd = Twist()\n        cmd.linear.x = 0.5  # Move forward\n        cmd.angular.z = 0.0\n        self.cmd_pub.publish(cmd)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"action-based-integration",children:"Action-Based Integration"}),"\n",(0,s.jsx)(n.p,{children:"For complex tasks that require feedback and cancelation:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from rclpy.action import ActionServer, ActionClient\nfrom control_msgs.action import FollowJointTrajectory\n\nclass AIPlanner(Node):\n\n    def __init__(self):\n        super().__init__('ai_planner')\n        self.trajectory_client = ActionClient(self, FollowJointTrajectory, '/joint_trajectory_controller/follow_joint_trajectory')\n\n    def execute_trajectory(self, joint_names, trajectory_points):\n        goal_msg = FollowJointTrajectory.Goal()\n        goal_msg.trajectory.joint_names = joint_names\n        goal_msg.trajectory.points = trajectory_points\n\n        self.trajectory_client.wait_for_server()\n        send_goal_future = self.trajectory_client.send_goal_async(\n            goal_msg,\n            feedback_callback=self.trajectory_feedback_callback)\n\n        send_goal_future.add_done_callback(self.trajectory_response_callback)\n\n    def trajectory_feedback_callback(self, feedback_msg):\n        self.get_logger().info(f'Trajectory progress: {feedback_msg.feedback.actual.positions}')\n\n    def trajectory_response_callback(self, future):\n        goal_handle = future.result()\n        if goal_handle.accepted:\n            self.get_logger().info('Trajectory accepted, waiting for result...')\n            get_result_future = goal_handle.get_result_async()\n            get_result_future.add_done_callback(self.trajectory_result_callback)\n\n    def trajectory_result_callback(self, future):\n        result = future.result().result\n        self.get_logger().info(f'Trajectory execution result: {result.error_code}')\n"})}),"\n",(0,s.jsx)(n.h2,{id:"safety-considerations",children:"Safety Considerations"}),"\n",(0,s.jsx)(n.h3,{id:"emergency-stop-integration",children:"Emergency Stop Integration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from std_msgs.msg import Bool\n\nclass SafetyMonitor(Node):\n\n    def __init__(self):\n        super().__init__('safety_monitor')\n        self.emergency_stop_pub = self.create_publisher(Bool, '/emergency_stop', 10)\n        self.ai_cmd_sub = self.create_subscription(Twist, '/ai_cmd_vel', self.ai_cmd_callback, 10)\n        self.controller_cmd_pub = self.create_publisher(Twist, '/cmd_vel', 10)\n\n    def ai_cmd_callback(self, msg):\n        # Check if command is safe\n        if self.is_command_safe(msg):\n            # Forward to controller\n            self.controller_cmd_pub.publish(msg)\n        else:\n            # Send emergency stop\n            stop_msg = Bool()\n            stop_msg.data = True\n            self.emergency_stop_pub.publish(stop_msg)\n            self.get_logger().error('Unsafe command detected, emergency stop activated!')\n\n    def is_command_safe(self, cmd):\n        # Implement safety checks\n        if abs(cmd.linear.x) > 1.0:  # Max linear velocity\n            return False\n        if abs(cmd.angular.z) > 1.0:  # Max angular velocity\n            return False\n        return True\n"})}),"\n",(0,s.jsx)(n.h3,{id:"state-validation",children:"State Validation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"class StateValidator(Node):\n\n    def __init__(self):\n        super().__init__('state_validator')\n        self.joint_state_sub = self.create_subscription(JointState, '/joint_states', self.validate_state, 10)\n\n    def validate_state(self, msg):\n        for i, name in enumerate(msg.name):\n            position = msg.position[i] if i < len(msg.position) else 0.0\n\n            # Check if position is within safe limits\n            if not self.is_position_safe(name, position):\n                self.get_logger().error(f'Unsafe position for joint {name}: {position}')\n                # Trigger safety response\n                self.trigger_safety_response(name, position)\n\n    def is_position_safe(self, joint_name, position):\n        # Define safe limits for each joint\n        limits = {\n            'joint1': (-3.14, 3.14),\n            'joint2': (-1.57, 1.57),\n            # Add more joint limits as needed\n        }\n\n        if joint_name in limits:\n            min_limit, max_limit = limits[joint_name]\n            return min_limit <= position <= max_limit\n        return True  # Assume safe if not specified\n"})}),"\n",(0,s.jsx)(n.h2,{id:"advanced-integration-ai-controller-coordination",children:"Advanced Integration: AI-Controller Coordination"}),"\n",(0,s.jsx)(n.h3,{id:"coordination-node",children:"Coordination Node"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'class AIControllerCoordinator(Node):\n\n    def __init__(self):\n        super().__init__(\'ai_controller_coordinator\')\n\n        # AI communication\n        self.ai_command_sub = self.create_subscription(String, \'/ai_commands\', self.ai_command_callback, 10)\n        self.ai_feedback_pub = self.create_publisher(String, \'/ai_feedback\', 10)\n\n        # Controller communication\n        self.controller_status_sub = self.create_subscription(String, \'/controller_status\', self.controller_status_callback, 10)\n        self.controller_cmd_pub = self.create_publisher(String, \'/controller_commands\', 10)\n\n        # State tracking\n        self.current_state = "IDLE"\n        self.ai_goals = []\n        self.controller_status = {}\n\n    def ai_command_callback(self, msg):\n        command = msg.data\n        if command.startswith("GOAL:"):\n            goal = command[5:]  # Remove "GOAL:" prefix\n            self.ai_goals.append(goal)\n            self.execute_next_goal()\n        elif command == "STOP":\n            self.stop_robot()\n        elif command == "RESET":\n            self.reset_system()\n\n    def controller_status_callback(self, msg):\n        # Update controller status\n        status = msg.data\n        self.controller_status = self.parse_status(status)\n\n        # Check if current goal is completed\n        if self.current_state == "EXECUTING" and self.is_goal_completed():\n            self.current_state = "IDLE"\n            self.send_feedback("GOAL_COMPLETED")\n\n    def execute_next_goal(self):\n        if self.ai_goals and self.current_state == "IDLE":\n            next_goal = self.ai_goals.pop(0)\n            self.current_state = "EXECUTING"\n\n            # Send goal to controller\n            cmd_msg = String()\n            cmd_msg.data = f"EXECUTE:{next_goal}"\n            self.controller_cmd_pub.publish(cmd_msg)\n\n    def is_goal_completed(self):\n        # Check if the current goal has been completed\n        # This is a simplified check - in practice, you\'d check actual robot state\n        return self.controller_status.get(\'completed\', False)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,s.jsx)(n.h3,{id:"communication-frequency",children:"Communication Frequency"}),"\n",(0,s.jsx)(n.p,{children:"Different types of communication require different frequencies:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"High-frequency (100Hz+)"}),": Joint states, sensor data, velocity commands"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Medium-frequency (10-50Hz)"}),": Position commands, odometry, basic feedback"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Low-frequency (1-10Hz)"}),": High-level goals, status updates, configuration"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"quality-of-service-settings",children:"Quality of Service Settings"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, QoSDurabilityPolicy, QoSHistoryPolicy, QoSReliabilityPolicy\n\nclass QoSAwareNode(Node):\n\n    def __init__(self):\n        super().__init__('qos_aware_node')\n\n        # High-priority, reliable communication for safety-critical data\n        reliable_qos = QoSProfile(\n            depth=10,\n            durability=QoSDurabilityPolicy.TRANSIENT_LOCAL,\n            reliability=QoSReliabilityPolicy.RELIABLE,\n            history=QoSHistoryPolicy.KEEP_LAST\n        )\n\n        # Best-effort for sensor data where some loss is acceptable\n        sensor_qos = QoSProfile(\n            depth=5,\n            durability=QoSDurabilityPolicy.VOLATILE,\n            reliability=QoSReliabilityPolicy.BEST_EFFORT,\n            history=QoSHistoryPolicy.KEEP_LAST\n        )\n\n        self.critical_pub = self.create_publisher(String, '/critical_data', reliable_qos)\n        self.sensor_pub = self.create_publisher(LaserScan, '/scan', sensor_qos)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(n.p,{children:"Effective communication between AI logic and robot controllers is fundamental to creating capable robotic systems. By understanding the different communication patterns, safety considerations, and integration strategies, you can design systems that leverage the decision-making power of AI while maintaining the precision and reliability of low-level control. The examples provided demonstrate various approaches to connecting these different system components, from simple command-state loops to complex coordinated behaviors."})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>a,x:()=>l});var t=o(6540);const s={},i=t.createContext(s);function a(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);